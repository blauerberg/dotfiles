command_exists() {
  type $1 > /dev/null 2>&1;
}

command_exists "brew"
if [ $? -eq 0 ]; then
  export PATH=/usr/local/bin:/usr/local/sbin:$PATH
fi

command_exists "direnv"
if [ $? -eq 0 ]; then
  eval "$(direnv hook zsh)"
fi

# rbenv
if [ -d "$HOME/.rbenv" ]; then
  export PATH=$HOME/.rbenv/bin:$PATH
fi
command_exists "rbenv"
if [ $? -eq 0 ]; then
  eval "$(rbenv init -)"
fi

# phpenv
if [ -d "$HOME/.phpenv" ]; then
  export PATH=$HOME/.phpenv/bin:$PATH
fi
command_exists "phpenv"
if [ $? -eq 0 ]; then
  eval "$(phpenv init -)"
fi

# docker machine
command_exists "docker-machine"
if [ $? -eq 0 ]; then
  DEFAULT_DOCKERMACHINE_STATE=$(docker-machine ls default|tail -n1|awk '{print $4}')
  if [ DEFAULT_DOCKERMACHINE_STATE = "Running" ]; then
    eval "$(docker-machine env default)"
  fi
fi

# DrupalConsole
if [ -f "$HOME/.console/console.rc" ]; then
  source "$HOME/.console/console.rc" 2>/dev/null
fi

# git-flow-completion
if [ -d "$HOME/dotfiles/git-flow-completion" ]; then
  source "$HOME/dotfiles/git-flow-completion/git-flow-completion.zsh" 2>/dev/null
fi

command_exists "tmux"
if [ $? -eq 0 ]; then
  case ${OSTYPE} in
    darwin*)
      ;;
    *)
      test -z "$TMUX" && (tmux attach || tmux new-session)
      ;;
  esac
fi
